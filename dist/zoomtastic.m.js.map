{"version":3,"file":"zoomtastic.m.js","sources":["../src/polyfills.js","../src/zoomtastic.ts"],"sourcesContent":["// Object.assign polyfill\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\r\nif (!Object.assign) {\r\n\tconsole.log('Object.assing polyfill enabled');\r\n\r\n\tObject.defineProperty(Object, 'assign', {\r\n\t\tenumerable: false,\r\n\t\tconfigurable: true,\r\n\t\twritable: true,\r\n\t\tvalue: function (target) {\r\n\t\t\t'use strict';\r\n\r\n\t\t\tif (target === undefined || target === null) {\r\n\t\t\t\tthrow new TypeError('Cannot convert first argument to object');\r\n\t\t\t}\r\n\r\n\t\t\tvar to = Object(target);\r\n\t\t\tfor (var i = 1; i < arguments.length; i++) {\r\n\t\t\t\tvar nextSource = arguments[i];\r\n\t\t\t\tif (nextSource === undefined || nextSource === null) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tnextSource = Object(nextSource);\r\n\r\n\t\t\t\tvar keysArray = Object.keys(Object(nextSource));\r\n\t\t\t\tfor (var nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex++) {\r\n\t\t\t\t\tvar nextKey = keysArray[nextIndex];\r\n\t\t\t\t\tvar desc = Object.getOwnPropertyDescriptor(nextSource, nextKey);\r\n\t\t\t\t\tif (desc !== undefined && desc.enumerable) {\r\n\t\t\t\t\t\tto[nextKey] = nextSource[nextKey];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn to;\r\n\t\t},\r\n\t});\r\n}\r\n\r\n// NodeList.forEach polyfill\r\n// https://developer.mozilla.org/en-US/docs/Web/API/NodeList/forEach\r\nif (window.NodeList && !NodeList.prototype.forEach) {\r\n\tconsole.log('NodeList.forEach polyfill enabled');\r\n\r\n\tNodeList.prototype.forEach = function (callback, thisArg) {\r\n\t\tthisArg = thisArg || window;\r\n\t\tfor (var i = 0; i < this.length; i++) {\r\n\t\t\tcallback.call(thisArg, this[i], i, this);\r\n\t\t}\r\n\t};\r\n}\r\n","// Polyfills for IE support\r\nimport './polyfills';\r\n\r\n/** Zoomtastic config */\r\ninterface ZoomtasticConfig {\r\n\tpreload?: boolean;\r\n\tduration?: number;\r\n\tdelay?: number;\r\n\tbackground?: string;\r\n\teasing?: string;\r\n\tzIndex?: string | number;\r\n\ttop?: string | number;\r\n\tleft?: string | number;\r\n\twidth?: string | number;\r\n\theight?: string | number;\r\n\tbaseTop?: string | number;\r\n\tbaseLeft?: string | number;\r\n\tbaseWidth?: string | number;\r\n\tbaseHeight?: string | number;\r\n\tonShow?: () => void;\r\n\tonHide?: () => void;\r\n}\r\n\r\n/** Zoomtastic - Tiny image zoomer for web! */\r\nclass Zoomtastic {\r\n\tprivate delayTimer: NodeJS.Timeout;\r\n\tprivate durationTimer: NodeJS.Timeout;\r\n\r\n\tprivate config: ZoomtasticConfig = {\r\n\t\tpreload: true,\r\n\t\tduration: 150,\r\n\t\tdelay: 200,\r\n\t\tbackground: 'rgba(0, 0, 0, 0.75)',\r\n\t\teasing: 'ease-out',\r\n\t\tzIndex: '16777271',\r\n\t\ttop: '50%',\r\n\t\tleft: '50%',\r\n\t\twidth: '95%',\r\n\t\theight: '95%',\r\n\t\tbaseTop: '55%',\r\n\t\tbaseLeft: '50%',\r\n\t\tbaseHeight: '90%',\r\n\t\tbaseWidth: '90%',\r\n\t};\r\n\r\n\t/**\r\n\t * Setup zoomtastic\r\n\t * @param config Viewer config\r\n\t */\r\n\tconstructor(config?: ZoomtasticConfig) {\r\n\t\tif (config) {\r\n\t\t\tif (typeof this.config !== 'object') throw new TypeError('Config must be an object');\r\n\t\t\tthis.config = Object.assign(this.config, config);\r\n\r\n\t\t\tif (typeof this.config.preload !== 'boolean') throw new TypeError('Field \"preload\" must be a boolean');\r\n\t\t\tif (typeof this.config.duration !== 'number') throw new TypeError('Field \"duration\" must be a number');\r\n\t\t\tif (typeof this.config.delay !== 'number') throw new TypeError('Field \"delay\" must be a number');\r\n\t\t\tif (typeof this.config.background !== 'string') throw new TypeError('Field \"background\" must be a string');\r\n\t\t\tif (typeof this.config.easing !== 'string') throw new TypeError('Field \"easing\" must be a string');\r\n\t\t\tif (typeof this.config.top !== 'string') throw new TypeError('Field \"top\" must be a string');\r\n\t\t\tif (typeof this.config.left !== 'string') throw new TypeError('Field \"left\" must be a string');\r\n\t\t\tif (typeof this.config.width !== 'string' && typeof this.config.width !== 'number') throw new TypeError('Field \"width\" must be a number or string');\r\n\t\t\tif (typeof this.config.height !== 'string' && typeof this.config.height !== 'number') throw new TypeError('Field \"height\" must be a number or string');\r\n\t\t}\r\n\r\n\t\t// Mount elements to the page\r\n\t\tthis.mount();\r\n\t}\r\n\r\n\t/**\r\n\t * Initialize viewer element\r\n\t */\r\n\tprivate mount(): void {\r\n\t\tconst existingContainer: HTMLElement = document.getElementById('zoomtastic-container');\r\n\t\tif (existingContainer) existingContainer.remove();\r\n\r\n\t\t// Container element\r\n\t\tconst container: HTMLDivElement = document.createElement('div');\r\n\t\tcontainer.id = 'zoomtastic-container';\r\n\t\tcontainer.style.top = '0';\r\n\t\tcontainer.style.left = '0';\r\n\t\tcontainer.style.width = '100%';\r\n\t\tcontainer.style.height = '100vh';\r\n\t\tcontainer.style.cursor = 'zoom-out';\r\n\t\tcontainer.style.opacity = '0';\r\n\t\tcontainer.style.position = 'fixed';\r\n\t\tcontainer.style.overflow = 'hidden';\r\n\t\tcontainer.style.zIndex = String(this.config.zIndex);\r\n\t\tcontainer.style.backgroundColor = this.config.background;\r\n\t\tcontainer.style.transitionProperty = 'all';\r\n\t\tcontainer.style.transitionDuration = this.config.duration + 'ms';\r\n\t\tcontainer.style.transitionTimingFunction = this.config.easing;\r\n\t\tcontainer.style.display = 'none';\r\n\r\n\t\t// Image element\r\n\t\tconst image: HTMLDivElement = document.createElement('div');\r\n\t\timage.id = 'zoomtastic-image';\r\n\t\timage.style.top = String(this.config.baseTop);\r\n\t\timage.style.left = String(this.config.baseLeft);\r\n\t\timage.style.width = String(this.config.baseWidth);\r\n\t\timage.style.height = String(this.config.baseHeight);\r\n\t\timage.style.zIndex = String(this.config.zIndex);\r\n\t\timage.style.opacity = '0';\r\n\t\timage.style.display = 'block';\r\n\t\timage.style.position = 'absolute';\r\n\t\timage.style.transform = 'translate(-50%, -50%)';\r\n\t\timage.style.backgroundSize = 'contain';\r\n\t\timage.style.backgroundRepeat = 'no-repeat';\r\n\t\timage.style.backgroundPosition = 'center';\r\n\t\timage.style.transitionProperty = 'all';\r\n\t\timage.style.transitionDuration = this.config.duration + 'ms';\r\n\t\timage.style.transitionTimingFunction = this.config.easing;\r\n\r\n\t\tcontainer.addEventListener('click', () => this.hide());\r\n\r\n\t\tcontainer.appendChild(image);\r\n\t\tdocument.body.appendChild(container);\r\n\t}\r\n\r\n\t/**\r\n\t * Listen elements for automatic image zooming\r\n\t * @param selector Elements selector\r\n\t */\r\n\tpublic listen(selector: string): void {\r\n\t\tconst elements: NodeListOf<Element> = document.querySelectorAll('[zoomtastic]');\r\n\r\n\t\t// Add event listener to each found element\r\n\t\telements.forEach((item: HTMLElement) => {\r\n\t\t\titem.style.cursor = 'zoom-in';\r\n\r\n\t\t\titem.addEventListener('click', (event: MouseEvent) => {\r\n\t\t\t\tevent.preventDefault();\r\n\r\n\t\t\t\t// Get image url from attributes\r\n\t\t\t\tlet url: string = item.getAttribute('zoomtastic') || item.getAttribute('src');\r\n\t\t\t\tif (url) this.show(url);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Show image\r\n\t * @param url Image url\r\n\t */\r\n\tpublic show(url: string): void {\r\n\t\tlet ready: boolean = !this.config.preload;\r\n\r\n\t\tconst container = document.getElementById('zoomtastic-container');\r\n\t\tconst image = document.getElementById('zoomtastic-image');\r\n\r\n\t\t// Show container\r\n\t\tcontainer.style.display = 'block';\r\n\t\tsetTimeout(() => (container.style.opacity = '1'), 0);\r\n\r\n\t\t// Preload image\r\n\t\tif (this.config.preload) {\r\n\t\t\tconst preloadedImage = new Image();\r\n\t\t\tpreloadedImage.onload = () => (ready = true);\r\n\t\t\tpreloadedImage.src = url;\r\n\t\t}\r\n\r\n\t\t// Show image\r\n\t\tsetTimeout(() => {\r\n\t\t\tconst loading = setInterval(() => {\r\n\t\t\t\tif (ready) {\r\n\t\t\t\t\timage.style.backgroundImage = `url(\"${url}\")`;\r\n\t\t\t\t\timage.style.opacity = '1';\r\n\t\t\t\t\timage.style.top = String(this.config.top);\r\n\t\t\t\t\timage.style.left = String(this.config.left);\r\n\t\t\t\t\timage.style.width = String(this.config.width);\r\n\t\t\t\t\timage.style.height = String(this.config.height);\r\n\r\n\t\t\t\t\tif (typeof this.config.onShow === 'function') this.config.onShow();\r\n\t\t\t\t\tclearInterval(loading);\r\n\t\t\t\t}\r\n\t\t\t}, 10);\r\n\t\t}, this.config.delay);\r\n\t}\r\n\r\n\t/**\r\n\t * Hide zoomed image\r\n\t */\r\n\tpublic hide(): void {\r\n\t\tconst container = document.getElementById('zoomtastic-container');\r\n\t\tconst image = document.getElementById('zoomtastic-image');\r\n\r\n\t\t// Hide image\r\n\t\timage.style.opacity = '0';\r\n\t\timage.style.top = String(this.config.baseTop);\r\n\t\timage.style.left = String(this.config.baseLeft);\r\n\t\timage.style.width = String(this.config.baseWidth);\r\n\t\timage.style.height = String(this.config.baseHeight);\r\n\r\n\t\t// Hide container\r\n\t\tsetTimeout(() => {\r\n\t\t\tcontainer.style.opacity = '0';\r\n\t\t\tif (typeof this.config.onHide === 'function') this.config.onHide();\r\n\r\n\t\t\t// Set display none after transition\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tcontainer.style.display = 'none';\r\n\t\t\t}, this.config.duration);\r\n\t\t}, this.config.delay);\r\n\t}\r\n}\r\n\r\nexport default Zoomtastic;\r\n"],"names":["Object","assign","console","log","defineProperty","enumerable","configurable","writable","value","target","TypeError","to","i","arguments","length","nextSource","keysArray","keys","nextIndex","len","nextKey","desc","getOwnPropertyDescriptor","undefined","window","NodeList","prototype","forEach","callback","thisArg","this","call","Zoomtastic","constructor","config","preload","duration","delay","background","easing","zIndex","top","left","width","height","baseTop","baseLeft","baseHeight","baseWidth","mount","existingContainer","document","getElementById","remove","container","createElement","id","style","cursor","opacity","position","overflow","String","backgroundColor","transitionProperty","transitionDuration","transitionTimingFunction","display","image","transform","backgroundSize","backgroundRepeat","backgroundPosition","addEventListener","hide","appendChild","body","listen","selector","querySelectorAll","item","event","preventDefault","url","getAttribute","show","ready","setTimeout","preloadedImage","Image","onload","src","loading","setInterval","backgroundImage","onShow","clearInterval","onHide"],"mappings":"AAEKA,OAAOC,SACXC,QAAQC,IAAI,kCAEZH,OAAOI,eAAeJ,OAAQ,SAAU,CACvCK,YAAY,EACZC,cAAc,EACdC,UAAU,EACVC,MAAO,SAAUC,sBAGZA,MAAAA,QACG,IAAIC,UAAU,mDAGjBC,EAAKX,OAAOS,GACPG,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,KACtCG,EAAaF,EAAUD,MACvBG,MAAAA,GAGJA,EAAaf,OAAOe,WAEhBC,EAAYhB,OAAOiB,KAAKjB,OAAOe,IAC1BG,EAAY,EAAGC,EAAMH,EAAUF,OAAQI,EAAYC,EAAKD,IAAa,KACzEE,EAAUJ,EAAUE,GACpBG,EAAOrB,OAAOsB,yBAAyBP,EAAYK,QAC1CG,IAATF,GAAsBA,EAAKhB,aAC9BM,EAAGS,GAAWL,EAAWK,aAIrBT,MAONa,OAAOC,WAAaA,SAASC,UAAUC,UAC1CzB,QAAQC,IAAI,qCAEZsB,SAASC,UAAUC,QAAU,SAAUC,EAAUC,GAChDA,EAAUA,GAAWL,WAChB,IAAIZ,EAAI,EAAGA,EAAIkB,KAAKhB,OAAQF,IAChCgB,EAASG,KAAKF,EAASC,KAAKlB,GAAIA,EAAGkB,QCtBtC,IAAME,EAyBLC,SAAYC,kBArBuB,CAClCC,SAAS,EACTC,SAAU,IACVC,MAAO,IACPC,WAAY,sBACZC,OAAQ,WACRC,OAAQ,WACRC,IAAK,MACLC,KAAM,MACNC,MAAO,MACPC,OAAQ,MACRC,QAAS,MACTC,SAAU,MACVC,WAAY,MACZC,UAAW,OAQPd,EAAQ,IACgB,iBAAhBJ,KAAKI,OAAqB,MAAM,IAAIxB,UAAU,oCACpDwB,OAASlC,OAAOC,OAAO6B,KAAKI,OAAQA,GAEN,kBAAxBJ,KAAKI,OAAOC,QAAuB,MAAM,IAAIzB,UAAU,wCAC9B,iBAAzBoB,KAAKI,OAAOE,SAAuB,MAAM,IAAI1B,UAAU,wCACjC,iBAAtBoB,KAAKI,OAAOG,MAAoB,MAAM,IAAI3B,UAAU,qCACzB,iBAA3BoB,KAAKI,OAAOI,WAAyB,MAAM,IAAI5B,UAAU,0CAClC,iBAAvBoB,KAAKI,OAAOK,OAAqB,MAAM,IAAI7B,UAAU,sCACjC,iBAApBoB,KAAKI,OAAOO,IAAkB,MAAM,IAAI/B,UAAU,mCAC7B,iBAArBoB,KAAKI,OAAOQ,KAAmB,MAAM,IAAIhC,UAAU,oCAC7B,iBAAtBoB,KAAKI,OAAOS,OAAmD,iBAAtBb,KAAKI,OAAOS,MAAoB,MAAM,IAAIjC,UAAU,+CACtE,iBAAvBoB,KAAKI,OAAOU,QAAqD,iBAAvBd,KAAKI,OAAOU,OAAqB,MAAM,IAAIlC,UAAU,kDAItGuC,qBAMEA,4BACDC,EAAiCC,SAASC,eAAe,wBAC3DF,GAAmBA,EAAkBG,aAGnCC,EAA4BH,SAASI,cAAc,OACzDD,EAAUE,GAAK,uBACfF,EAAUG,MAAMhB,IAAM,IACtBa,EAAUG,MAAMf,KAAO,IACvBY,EAAUG,MAAMd,MAAQ,OACxBW,EAAUG,MAAMb,OAAS,QACzBU,EAAUG,MAAMC,OAAS,WACzBJ,EAAUG,MAAME,QAAU,IAC1BL,EAAUG,MAAMG,SAAW,QAC3BN,EAAUG,MAAMI,SAAW,SAC3BP,EAAUG,MAAMjB,OAASsB,OAAOhC,KAAKI,OAAOM,QAC5Cc,EAAUG,MAAMM,gBAAkBjC,KAAKI,OAAOI,WAC9CgB,EAAUG,MAAMO,mBAAqB,MACrCV,EAAUG,MAAMQ,mBAAqBnC,KAAKI,OAAOE,SAAW,KAC5DkB,EAAUG,MAAMS,yBAA2BpC,KAAKI,OAAOK,OACvDe,EAAUG,MAAMU,QAAU,WAGpBC,EAAwBjB,SAASI,cAAc,OACrDa,EAAMZ,GAAK,mBACXY,EAAMX,MAAMhB,IAAMqB,OAAOhC,KAAKI,OAAOW,SACrCuB,EAAMX,MAAMf,KAAOoB,OAAOhC,KAAKI,OAAOY,UACtCsB,EAAMX,MAAMd,MAAQmB,OAAOhC,KAAKI,OAAOc,WACvCoB,EAAMX,MAAMb,OAASkB,OAAOhC,KAAKI,OAAOa,YACxCqB,EAAMX,MAAMjB,OAASsB,OAAOhC,KAAKI,OAAOM,QACxC4B,EAAMX,MAAME,QAAU,IACtBS,EAAMX,MAAMU,QAAU,QACtBC,EAAMX,MAAMG,SAAW,WACvBQ,EAAMX,MAAMY,UAAY,wBACxBD,EAAMX,MAAMa,eAAiB,UAC7BF,EAAMX,MAAMc,iBAAmB,YAC/BH,EAAMX,MAAMe,mBAAqB,SACjCJ,EAAMX,MAAMO,mBAAqB,MACjCI,EAAMX,MAAMQ,mBAAqBnC,KAAKI,OAAOE,SAAW,KACxDgC,EAAMX,MAAMS,yBAA2BpC,KAAKI,OAAOK,OAEnDe,EAAUmB,iBAAiB,0BAAe3C,EAAK4C,SAE/CpB,EAAUqB,YAAYP,GACtBjB,SAASyB,KAAKD,YAAYrB,gBAOpBuB,gBAAOC,cACyB3B,SAAS4B,iBAAiB,gBAGvDpD,iBAASqD,GACjBA,EAAKvB,MAAMC,OAAS,UAEpBsB,EAAKP,iBAAiB,iBAAUQ,GAC/BA,EAAMC,qBAGFC,EAAcH,EAAKI,aAAa,eAAiBJ,EAAKI,aAAa,OACnED,GAAKrD,EAAKuD,KAAKF,oBASfE,cAAKF,cACPG,GAAkBxD,KAAKI,OAAOC,QAE5BmB,EAAYH,SAASC,eAAe,wBACpCgB,EAAQjB,SAASC,eAAe,uBAGtCE,EAAUG,MAAMU,QAAU,QAC1BoB,6BAAkBjC,EAAUG,MAAME,QAAU,KAAM,GAG9C7B,KAAKI,OAAOC,QAAS,KAClBqD,EAAiB,IAAIC,MAC3BD,EAAeE,yBAAgBJ,GAAQ,GACvCE,EAAeG,IAAMR,EAItBI,0BACOK,EAAUC,uBACXP,IACHlB,EAAMX,MAAMqC,wBAA0BX,OACtCf,EAAMX,MAAME,QAAU,IACtBS,EAAMX,MAAMhB,IAAMqB,OAAOhC,EAAKI,OAAOO,KACrC2B,EAAMX,MAAMf,KAAOoB,OAAOhC,EAAKI,OAAOQ,MACtC0B,EAAMX,MAAMd,MAAQmB,OAAOhC,EAAKI,OAAOS,OACvCyB,EAAMX,MAAMb,OAASkB,OAAOhC,EAAKI,OAAOU,QAEN,mBAAvBd,EAAKI,OAAO6D,QAAuBjE,EAAKI,OAAO6D,SAC1DC,cAAcJ,KAEb,KACD9D,KAAKI,OAAOG,oBAMTqC,2BACApB,EAAYH,SAASC,eAAe,wBACpCgB,EAAQjB,SAASC,eAAe,oBAGtCgB,EAAMX,MAAME,QAAU,IACtBS,EAAMX,MAAMhB,IAAMqB,OAAOhC,KAAKI,OAAOW,SACrCuB,EAAMX,MAAMf,KAAOoB,OAAOhC,KAAKI,OAAOY,UACtCsB,EAAMX,MAAMd,MAAQmB,OAAOhC,KAAKI,OAAOc,WACvCoB,EAAMX,MAAMb,OAASkB,OAAOhC,KAAKI,OAAOa,YAGxCwC,sBACCjC,EAAUG,MAAME,QAAU,IACQ,mBAAvB7B,EAAKI,OAAO+D,QAAuBnE,EAAKI,OAAO+D,SAG1DV,sBACCjC,EAAUG,MAAMU,QAAU,QACxBrC,EAAKI,OAAOE,WACbN,KAAKI,OAAOG"}